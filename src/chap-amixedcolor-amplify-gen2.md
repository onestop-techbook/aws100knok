---
class: chapter
---

# WebアプリのMVP開発にうってつけ！「Amplify Gen2」について

<div class="flush-right">
保 龍児（エイミ/amixedcolor）
</div>


筆者はちょうど今月でAWS歴1年たったばかりの新参者ですが、その1年の中で一番多く扱い、一番大きなシステムを組み上げたのはAmplify Gen2を使ったものでした。
Amplify Gen2はGen1と比べても多くのことが変わりましたが、その中から推しポイントを3つ紹介します。

## その前に：そもそもAmplify Gen2とは？

元々は無印のAmplifyとして提供されていたAmplifyが進化したものがAmplify Gen2です。
AWS Amplifyは、Webアプリ・モバイルアプリ開発に必要なものを全て備えており、簡単に構築し、拡張することができます。

　

公式ドキュメントはこちら

https://docs.amplify.aws/

## 推しポイント１：簡単にHello Worldできる

前提として、AWSアカウントが必須で、GitHubアカウントもあると楽です。
なんと、全く初めて行った自分でも30分足らずでTodoアプリをデプロイでき、慣れてくるとQuickstartは10分程度（うちビルド・デプロイ待ち5分程度）でできるようになります。

自分にとってこの手軽さと、一切詰まることのなかったスムーズさは衝撃的でした。大学時代にハッカソンでElastic Beanstalkを使おうとして延々トラブルシュートして結局デプロイできなかったのはいい思い出ですが、ここまで簡単にデプロイできるとは思いもよりませんでした。
筆者はGen1のホスティング以外を触ったことがろくになかったため、Gen2から触れており実はGen1時代からそうだったのかもしれませんが、初回の30分弱も **何か詰まったからそれだけ時間がかかったわけではなく** 説明をよく読んでいたり、慎重に作業していたからこその時間でした。

Webアプリをデプロイすること、特にバックエンドやDBも含めてとなるとかなり煩雑な印象があり、初心者が行ってもエラーに阻まれるイメージが強かったですが、今ではAmplify Gen2を使えばそれは簡単にでき、恐れなくていいと思うようになりました。

## 推しポイント２：認証・DB・ストレージなど必要な機能をシームレスに使える

Amplify Gen2ではいろいろなAWSサービスと統合して、ベストプラクティスに沿った開発ができるようになっていますが、中でもWebアプリでは欠かせないことが多い「認証」「データベース」「ストレージ」においてもシームレスに統合できます。

### 認証：Amplify Auth

認証は内部的にはCognitoを使用していますが、Amplify Authというラッパーのような仕組みに沿って簡単にTypeScriptを記述するだけで、カスタマイズもしながら認証機能を実装できます。また、Amplify UIのAuthenticatorコンポーネントによって、そのコンポーネントで認証をかけたいコンポーネントをラッピングするだけで、新規会員登録・ログイン・パスワードリセットなどの機能をUIまで提供してくれていることも非常に便利でおすすめポイントです。もちろん、UIもカスタマイズすることが可能になっています。

### DB：Amplify Data

データベースはデフォルトで内部的にはDynamoDBを使用していますが、Amplify Dataというラッパーのような仕組みに沿って簡単にAPIのように呼び出すことができます。実は内部ではAppSyncも使用しているため、一般的なDynamoDBでは制約のある部分一致検索も可能です。さらに、Amplify Dataはデフォルトで多くのAppSync関数を用意しており、リレーションを貼ることも非常に簡単にできます。もちろん、細かな部分はRDBと異なりますが、使い勝手として、基本的な部分はRDB + REST APIと変わらないと感じています。

Amplify Dataでは、データスキーマを記述するだけで、APIを書かずともCRUD処理が可能になることも非常に便利でおすすめポイントです。ユーザーに見せたくないカラムがあれば呼び出し時に適切に指定する必要があったり、いくつか注意する必要があることはありますが、スキーマを書いた直後からフロントエンドでメソッドを通してCRUD処理ができ、型チェックも自動的に行われるのは非常に魅力的だと感じます。

さらに、リアルタイムのデータ処理も非常に簡単に記述でき、わずか1行呼び出すメソッドを変えるだけで、内部的にはWebhookなどが用いられた、リアルタイムに同期したチャット画面が作れたりします。

GraphQLやAppSync、DynamoDBといった普段使い慣れない方も多いサービスを中で使っていますが、その実Amplify Dataがうまくそれを秘匿していて、新しく **Amplify Dataの記法** に慣れる必要はあれど、学習コストは非常に低いと考えています。

### ストレージ：Amplify Storage

ストレージは内部的にはS3を使用しており、細かな権限設定が可能です。Amplify Auth（Cognito）で設定した、その人がログインしているグループ別にできたり、Owner（そのオブジェクトの所有者）のみが扱えるようにしたり、同じオブジェクト・ファイルパスに対して複数の権限をRead（Get＆List）, Write, Delete, Get, Listの粒度で制限できます。一部、グループに所属する人に対してOwnerの認可を重ねがけできない問題があり、GitHub Issueになっていますが、私がそこで代替案を提示しています。実際に私自身活用している代替案ですが、もし実装に疑問があればX（@amixedcolor）でDMでも、そのIssue内でメンションでも大丈夫です。

　

Issue内での提案はこちら

https://github.com/aws-amplify/amplify-backend/issues/1771#issuecomment-2673850655

　

また、Amplify Storageにおいても複数のUIがAmplify UIによって定義されています。例えばFile Uploadのコンポーネントを使えば、簡単に指定したパスへファイルをアップロードすることが可能です。

### 推しポイント2のまとめ

このように、Amplify Gen2には多くの機能が備わっており、それらとのシームレスな結合によって、機能要件に開発リソースを注力させたり、コストをあまりかけずにWebアプリなどの作成・構築・デプロイをすることが可能です。

## 推しポイント３：CloudFormationでリソースを辿れる

Amplify Gen2では、AWS CDKと同様に、内部でCloudFormationテンプレートを作成、実行しています。それにより、以下2つの大きなメリットがあると考えています。

- 作成したリソースが散らからず、集約されているため管理しやすい
- 学習者が作成したリソースを追いやすく、AWSの理解に繋げやすい

Amplify Gen2はその作りやすさや管理のしやすさだけでなく、未経験であってもキャッチアップしやすく、その先のAWSに対するステップアップにも繋げやすいことが非常に魅力的だと感じています。
また、この変更はAmplify Gen1からの大きな変更の1つです。Gen1では、どうやら用意されたコマンドを叩くことによってAWSリソースを構築していて、構築しているもののそれはCloudFormation上などで管理ができなかったと聞いています。

また、今回深く触れていませんが、開発者自身がローカルPC上でAmplify Gen2を用いたアプリ開発をしていても、Amplify Sandboxというものを用いて、CloudFormationを通してクラウド上に構築されたバックエンドリソース/インフラリソースを使うことができます。これは、実際にデプロイする際の環境とほぼ同じ環境を用意できることで、さらに円滑な構築体験につながりました。

## さいごに

AWS推しポイントの1つとして、Amplify Gen2を紹介させていただきました。筆者はAmplify Gen1はホスティング部分くらいしか触れたことがなく、社内でインフラ構築のコストが比較的安い開発テンプレートを作る時に、初めてAmplify Gen2に触れました。まだドキュメンテーションされきっていない部分もあり、実際自分もサポートに何十回も問い合わせを行って開発を進めましたが、それを加味してもAmplify Gen2は非常に便利なサービスだと感じています。
特に、MVPやファンクショナルプロトタイプを開発しようとしている方は、ぜひAmplify Gen2を使うことを検討してみてください。

ここまでお読みいただきありがとうございました！
エイミでした。それでは、またこんど！

#### 著者紹介

---

<div class="author-profile">
    <img src="images/chap-amixedcolor/amixedcolor-logo.png" width="60%">
    <div>
        <div>
            <b>保 龍児（エイミ/amixedcolor）</b></br>
            X：<a href="https://x.com/amixedcolor">https://x.com/amixedcolor</a></br>
            Note：<a href="https://note.com/amixedcolor">https://note.com/amixedcolor</a></br>
            SpeakerDeck：<a href="https://speakerdeck.com/amixedcolor">https://speakerdeck.com/amixedcolor</a></br>
            GitHub：<a href="https://github.com/amixedcolor">https://github.com/amixedcolor</a></br>
            所属：<a href="https://relic.co.jp/">株式会社Relic（https://relic.co.jp/）</a>
        </div>
    </div>
</div>
<p style="margin-top: 0.5em; margin-bottom: 2em;">
すき：アジャイル、スクラム、新規事業開発、AWS、完全没入型仮想現実、音楽（きく・うたう・ライブ/イベント参加）、漫画、ゲーム</br>
</p>
